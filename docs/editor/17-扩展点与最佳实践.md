# 扩展点与最佳实践

工具（StateNode）
- 新建工具类继承 `StateNode`，实现事件回调与状态迁移；通过 `setTool` 注入，`setCurrentTool` 激活。
- 交互逻辑应全部置于工具层，不在 React 组件中进行业务计算。

形状（ShapeUtil）
- 定义 props 与样式（style id 全局唯一），实现 `getGeometry/component/indicator/clipPath/shouldClipChild/onChildrenChange`。
- 渲染分层：容器样式由 Editor 清单/缓存决定，内部 JSX 仅表达“如何画”。

绑定（BindingUtil）
- 衔接生命周期：onAfterChange*/onBefore*/onAfterDelete/onOperationComplete。
- 幂等与批处理友好：在事务阶段只记录，收敛时统一处理。

外部内容与导出
- 通过默认 handler 扩展自定义类型或策略（白名单、尺寸/格式限制）；
- 导出遵循相机/可见性/裁剪一致性。

最佳实践
- “数据进 Editor、渲染归 React、交互靠 StateNode”；
- 大操作使用 `run(transact)`；
- 高速路径使用 `unsafe__withoutCapture` 谨慎读取；
- 调试优先 `getRenderingShapes` 与相机/矩阵缓存，快速定位渲染瓶颈。

