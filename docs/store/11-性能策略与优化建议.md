# 性能策略与优化建议

读路径
- 热点读取：使用 `unsafeGetWithoutCapture/__unsafe__getWithoutCapture`；避免无意订阅。
- 复杂派生：使用 `createComputedCache` 按记录缓存（支持 records/result 等值相等短路）。

写路径
- 使用 `atomic` 批处理；远端合并时关闭 before*，结束后一次性 flush；
- 多删除：`AtomMap.deleteMany` 一次性删除/清理。

查询
- 优先用索引（`query.index`）+ 表达式执行器（`executeQuery`）；
- 大集合尽量避免“全表遍历+过滤”的 computed。

通知
- 依赖 `throttleToNextFrame` 的 history 推送，避免同帧内多次监听触发；
- 监听时设置 filters，仅订阅必要来源与作用域。

